---
lab:
    title: '实验室教学 1 - 监视器和自动扩展'
    module: '模块 2 - 实施平台保护'
---

# 模块 2：实验室教学 1 - 监视器和自动扩展


自动扩展是云服务、移动服务、虚拟机和网站的内置功能，可在需求变化时帮助应用程序发挥最佳性能。当然，性能对于不同的应用程序有着不同的意义。有些应用程序受 CPU 限制，人另一些应用程序受内存限制。例如，你有一个网络应用程序，该应用程序在白天处理数百万个请求，而在晚间则不处理。Autoscale 可以通过上述任何一种方式或你定义的自定义指标来扩展你的服务。


## 练习 1：实验室教学设置

1.  打开 PowerShell，然后运行以下命令：

     ```powershell
    start "https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FMicrosoftLearning%2FAZ-500-Azure-Security%2Fmaster%2FAllfiles%2FLabs%2FMod2_Lab01%2Ftemplate.json"
     ```

    *这将从模板中部署一个新的应用程序和应用程序服务计划，然后可用于演示 AZ500 模块 2 实验室 1中的扩展选项。*

1.  选择**“创建一个新资源组”**  

1.  为**“网站名称”**和**“服务计划”**输入一个**“唯一”**名称。 

1.  同意条款并单击购买

## 练习 2：创建你的第一个自动扩展设置


现在，我们通过一个简单的分步演练来创建你的第一个自动扩展设置。


1.  在 Azure Monitor 中打开**“自动缩放”**刀片服务器，然后选择要扩展的资源。你可以选择在设置过程中创建的应用程序服务计划
1.  请注意，当前实例计数为 1。请单击**“启用自动扩展”**。

1.  提供扩展设置名，然后单击**“添加一个规则”**。 

1.  请注意，扩展规则选项将在右侧作为背景窗格打开。默认情况下，如果资源的 CPU 百分比超过 70％，则此规则选项将实例计数设置为按 1 扩展。保留其默认值，然后单击**“添加”**。

1.  现在，你已经创建了第一个扩展规则。请注意，UX 建议最佳实践，并指出“建议规则中至少有一个扩展。”为此：

    - 请单击**“添加规则”**。

    - 将**“操作员”**设置为**“少于”**。

    - 将**“阈值”**设置为**“20”**。

    - 将**“运行方式”**设置为**“减少计数”**。

1.  单击**“添加”**。

1.  单击**“保存”**。


**恭喜你**！现在，你已经成功创建了第一个扩展设置，可以根据 CPU 使用率自动扩展你的网络应用程序。


## 练习 3：根据时间表扩展


除了基于 CPU 的扩展外，你还可以针对一周中的特定日期设置不同的扩展。


1.  请单击**“添加扩展条件”**。

1.  设置扩展模式和规则，与默认条件相同。
1.  选择时间表**“重复特定的日期”**。
1.  选择应用扩展条件的日期和开始/结束时间。


## 练习 4：不同日期的扩展有所不同


除了基于 CPU 的扩展外，你还可以为特定日期设置不同的扩展规则。


1.  请单击**“添加扩展条件”**。

1.  设置扩展模式和规则，与默认条件相同。
1.  选择时间表的**“特定开始/结束日期”**。
1.  选择应用扩展条件的开始/结束日期和开始/结束时间。



## 练习 5：  查看资源的扩展历史

1.  每当你的资源扩展或缩小时，活动日志中都会记录一个事件。你可以切换到**“运行记录”**选项卡，查看过去 24 小时内资源的扩展历史。

1.  如果要查看完整的扩展历史（最长 90 天），请选择**“单击这里查看更多详细信息”**。活动日志打开，其中包括你的资源和类别预选择的自动扩展。

## 练习 6：查看资源的扩展定义

1.  自动扩展是 Azure 资源管理器资源。你可以通过切换到**“JSON”**选项卡，查看 JSON 中的扩展定义。

1.  你可以在**“JSON”**中直接做出变更（如果需要）。保存后，将显示这些变更。


| 警告：在继续之前，你应该删除此实验室教学使用的所有资源。  为此，应在**“Azure 门户”**中，单击**“资源组”**。  选择你创建的任何资源组。  在资源组刀片服务器上，单击**“删除资源组”**，输入资源组名，然后单击**“删除”**。  对你创建的任何其他资源组重复该过程。**“否则可能会导致其他实验室教学出现问题”**。 |
| --- |


**“结果”**：现在你已经完成了本实验室教学。
